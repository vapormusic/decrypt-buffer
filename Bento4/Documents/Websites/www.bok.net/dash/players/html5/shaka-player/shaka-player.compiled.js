(function(){var g={};
(function(window){var k,aa=this;function m(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b}function s(a,b){function c(){}c.prototype=b.prototype;a.De=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Ae=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};function ba(){};function t(a){ca[a]={qb:da(),end:NaN}}function ea(a){if(a=ca[a])a.end=da()}function fa(a){return(a=ca[a])&&a.end?a.end-a.qb:NaN}var da=window.performance?window.performance.now.bind(window.performance):Date.now,ca={};function ga(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}m("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});function ha(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}m("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function ia(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function ja(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}m("shaka.player.VideoTrack.compare",ja);function ka(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=la)}m("shaka.polyfill.CustomEvent.install",ka);function la(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};function ma(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
na);document.addEventListener("webkitfullscreenerror",na);document.addEventListener("mozfullscreenchange",na);document.addEventListener("mozfullscreenerror",na);document.addEventListener("MSFullscreenChange",na);document.addEventListener("MSFullscreenError",na)}m("shaka.polyfill.Fullscreen.install",ma);function na(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};function oa(){return Promise.reject(Error("The key system specified is not supported."))}function pa(a){return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function qa(){throw new TypeError("Illegal constructor.");}qa.prototype.createSession=function(){};function ra(){throw new TypeError("Illegal constructor.");}ra.prototype.getConfiguration=function(){};ra.prototype.createMediaKeys=function(){};function sa(){var a=HTMLVideoElement.prototype;a.getVideoPlaybackQuality||(a.getVideoPlaybackQuality=function(){return"webkitDroppedFrameCount"in this?{corruptedVideoFrames:0,droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,creationTime:null,totalFrameDelay:null}:null})}m("shaka.polyfill.VideoPlaybackQuality.install",sa);function ta(a,b){for(var c={},d=0;d<a.length;++d){var e=b?b(a[d]):a[d].toString();c[e]=a[d]}var d=[],f;for(f in c)d.push(c[f]);return d};var ua=0;function va(a,b){this.j=a;this.wc=b==wa;this.h=0}var wa=1;va.prototype.Ha=function(){return this.h<this.j.byteLength};function xa(a){var b=a.j.getUint8(a.h);a.h+=1;return b}function v(a){var b=a.j.getUint32(a.h,a.wc);a.h+=4;return b}function ya(a){var b,c;a.wc?(b=a.j.getUint32(a.h,!0),c=a.j.getUint32(a.h+4,!0)):(c=a.j.getUint32(a.h,!1),b=a.j.getUint32(a.h+4,!1));if(2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.h+=8;return c*Math.pow(2,32)+b}
function za(a){if(a.h+16>a.j.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.j.buffer,a.h,16);a.h+=16;return b}function w(a,b){if(a.h+b>a.j.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.h+=b};function y(a){this.j=a;this.Oa=new va(a,0)}var Aa=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])];y.prototype.Ha=function(){return this.Oa.Ha()};
function z(a){var b;b=Ba(a);if(7<b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=Ba(a);a:{for(d=0;d<Aa.length;d++)if(Ca(c,Aa[d])){d=!0;break a}d=!1}if(d)throw new RangeError("EbmlParser: Element cannot contain dynamically sized data.");if(8==c.length&&c[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0]&(1<<8-c.length)-1,e=1;e<c.length;e++)d=256*d+c[e];c=d;c=
a.Oa.h+c<=a.j.byteLength?c:a.j.byteLength-a.Oa.h;d=new DataView(a.j.buffer,a.j.byteOffset+a.Oa.h,c);w(a.Oa,c);return new Da(b,d)}function Ba(a){var b=xa(a.Oa),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=xa(a.Oa);return d}function Da(a,b){this.id=a;this.j=b}
function Ea(a){if(8<a.j.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==a.j.byteLength&&a.j.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c<a.j.byteLength;c++)var d=a.j.getUint8(c),b=256*b+d;return b};function Fa(a){this.Oc=Math.exp(Math.log(.5)/a);this.gc=this.mc=0}Fa.prototype.sample=function(a,b){var c=Math.pow(this.Oc,a);this.mc=b*(1-c)+c*this.mc;this.gc+=a};function Ga(a){return a.mc/(1-Math.pow(a.Oc,a.gc))};function A(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function B(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function Ha(a,b,c){Ia(b);Ia(c);return c==b||a>=Ja&&c==b.split("-")[0]||a>=Ka&&c.split("-")[0]==b.split("-")[0]?!0:!1}var Ja=1,Ka=2;function Ia(a){a=a.toLowerCase().split("-");var b=La[a[0]];b&&(a[0]=b);return a.join("-")}
var La={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function C(){this.$={}}k=C.prototype;k.push=function(a,b){this.$.hasOwnProperty(a)?this.$[a].push(b):this.$[a]=[b]};k.set=function(a,b){this.$[a]=b};k.has=function(a){return this.$.hasOwnProperty(a)};k.get=function(a){return(a=this.$[a])?a.slice():null};function Ma(a){var b=[],c;for(c in a.$)b.push.apply(b,a.$[c]);return b}k.remove=function(a,b){var c=this.$[a];if(c)for(var d=0;d<c.length;++d)c[d]==b&&(c.splice(d,1),--d)};k.keys=function(){var a=[],b;for(b in this.$)a.push(b);return a};
k.clear=function(){this.$={}};function D(){this.Ua=new C}D.prototype.destroy=function(){Na(this);this.Ua=null};function E(a,b,c,d){b=new Oa(b,c,d);a.Ua.push(c,b)}D.prototype.Fb=function(a,b){for(var c=this.Ua.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.Fb(),this.Ua.remove(b,e))}};function Na(a){for(var b=Ma(a.Ua),c=0;c<b.length;++c)b[c].Fb();a.Ua.clear()}function Oa(a,b,c){this.target=a;this.type=b;this.bd=c;this.target.addEventListener(b,c,!1)}
Oa.prototype.Fb=function(){this.target&&(this.target.removeEventListener(this.type,this.bd,!1),this.bd=this.target=null)};function F(a){this.vc=new C;this.parent=a}m("shaka.util.FakeEventTarget",F);F.prototype.addEventListener=function(a,b,c){c||this.vc.push(a,b)};F.prototype.removeEventListener=function(a,b,c){c||this.vc.remove(a,b)};F.prototype.dispatchEvent=function(a){delete a.srcElement;delete a.target;delete a.currentTarget;Object.defineProperties(a,{srcElement:{value:null,writable:!0},target:{value:this,writable:!0},currentTarget:{value:null,writable:!0}});return Pa(this,a)};
function Pa(a,b){b.currentTarget=a;for(var c=a.vc.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){}}a.parent&&b.bubbles&&Pa(a.parent,b);return b.defaultPrevented};function G(){F.call(this,null);this.nc=new Fa(3);this.nd=new Fa(10);this.Ld=50;this.xd=5E5;this.Md=.5;this.Kd=65536;this.Zc=0}s(G,F);m("shaka.util.EWMABandwidthEstimator",G);G.prototype.sample=function(a,b){if(!(b<this.Kd)){a=Math.max(a,this.Ld);var c=8E3*b/a,d=a/1E3;this.nc.sample(d,c);this.nd.sample(d,c);this.dispatchEvent(A({type:"bandwidth"}));this.Zc=Date.now()}};G.prototype.getBandwidth=function(){return this.nc.gc<this.Md?this.xd:Math.min(Ga(this.nc),Ga(this.nd))};
G.prototype.getDataAge=function(){return(Date.now()-this.Zc)/1E3};function H(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;return c};function Qa(){this.Eb=new H;this.Cb=!1;this.da=null;this.Ba=[];this.Da=null}Qa.prototype.append=function(a){if(this.Cb)throw Error("Cannot append to a running task!");this.Ba.push(a)};Qa.prototype.start=function(){if(this.Cb)throw Error("Task already started!");this.Cb=!0;this.Ba.unshift(function(){});Ra(this,void 0)};
Qa.prototype.abort=function(){if(this.da)return this.da;var a=Error("Task aborted.");a.type="aborted";this.Eb.reject(a);if(!this.Cb)return this.Cb=!0,Promise.resolve();this.Da&&this.Da();return this.da=new H};Qa.prototype.end=function(){this.Ba.splice(1)};
function Ra(a,b){var c=a.Ba[0](b),d;c?(d=c[0],a.Da=c[1]):(d=Promise.resolve(),a.Da=null);d.then(function(a){this.da?(this.Ba=[],this.Da=null,this.da.resolve(),this.da=null):(this.Ba.shift(),this.Ba.length?Ra(this,a):(this.Eb.resolve(a),this.Da=null))}.bind(a)).catch(function(a){this.Eb.reject(a);this.Ba=[];this.Da=null;this.da&&(this.da.resolve(),this.da=null)}.bind(a))};function I(a,b){return b.bind(a)};function Sa(a){return String.fromCharCode.apply(null,a)}m("shaka.util.Uint8ArrayUtils.toString",Sa);function Ta(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}m("shaka.util.Uint8ArrayUtils.fromString",Ta);m("shaka.util.Uint8ArrayUtils.toBase64",function(a,b){var c=void 0==b?!0:b,d=window.btoa(Sa(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")});function Ua(a){return Ta(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")))}
m("shaka.util.Uint8ArrayUtils.fromBase64",Ua);m("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function Va(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}m("shaka.util.Uint8ArrayUtils.toHex",Va);function Ca(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};function Wa(a,b,c,d,e){this.keySystem=a;this.ad=b;this.withCredentials=c;this.Ja=[];this.$c=e;d&&this.Ja.push(d)}m("shaka.player.DrmSchemeInfo",Wa);function Xa(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.maxHeight=null}Xa.prototype.clone=function(){var a=new Xa;a.maxHeight=this.maxHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};function Ya(){return new Wa("","",!1,null,null)}Wa.createUnencrypted=Ya;
function Za(a,b){var c=new Wa(a.keySystem,a.ad,a.withCredentials,null,a.$c);c.Ja=ta(a.Ja.concat(b.Ja),function(a){return Array.prototype.join.apply(a.initData)});return c}Wa.combine=Za;Wa.prototype.key=function(){return JSON.stringify(this)};function $a(a,b){try{var c=new ab(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function bb(a){var b=this.mediaKeys;b&&b!=a&&db(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&db(a,this);return Promise.resolve()}
function ab(a,b){this.Za=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.Za="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes},l=!1;if(g.audioCapabilities)for(var n=0;n<g.audioCapabilities.length;++n){var p=g.audioCapabilities[n];p.contentType&&
(l=!0,e.canPlayType(p.contentType.split(";")[0],this.Za)&&(h.audioCapabilities.push(p),d=!0))}if(g.videoCapabilities)for(n=0;n<g.videoCapabilities.length;++n)p=g.videoCapabilities[n],p.contentType&&(l=!0,e.canPlayType(p.contentType,this.Za)&&(h.videoCapabilities.push(p),d=!0));l||(d=e.canPlayType("video/mp4",this.Za)||e.canPlayType("video/webm",this.Za));"required"==g.persistentState&&(c?h.persistentState="required":d=!1);if(d){this.wd=h;return}}throw Error("None of the requested configurations were supported.");
}ab.prototype.createMediaKeys=function(){var a=new eb(this.Za);return Promise.resolve(a)};ab.prototype.getConfiguration=function(){return this.wd};function eb(a){this.La=a;this.za=null;this.l=new D;this.ed=[];this.ld={}}function db(a,b){a.za=b;Na(a.l);b&&(E(a.l,b,"webkitneedkey",a.he.bind(a)),E(a.l,b,"webkitkeymessage",a.ge.bind(a)),E(a.l,b,"webkitkeyadded",a.ee.bind(a)),E(a.l,b,"webkitkeyerror",a.fe.bind(a)))}k=eb.prototype;
k.createSession=function(a){var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.za||document.createElement("video");a.src||(a.src="about:blank");b=new fb(a,this.La,b);this.ed.push(b);return b};k.he=function(a){a=A({type:"encrypted",initDataType:"webm",initData:a.initData});this.za.dispatchEvent(a)};
k.ge=function(a){var b=gb(this,a.sessionId);b&&(a=A({type:"message",messageType:void 0==b.keyStatuses.ta?"licenserequest":"licenserenewal",message:a.message}),b.X&&(b.X.resolve(),b.X=null),b.dispatchEvent(a))};k.ee=function(a){(a=gb(this,a.sessionId))&&a.ready()};k.fe=function(a){var b=gb(this,a.sessionId);b&&b.handleError(a)};function gb(a,b){var c=a.ld[b];return c?c:(c=a.ed.shift())?(c.sessionId=b,a.ld[b]=c):null}
function fb(a,b,c){F.call(this,null);this.za=a;this.Yc=!1;this.O=this.X=null;this.La=b;this.Ra=c;this.sessionId="";this.expiration=NaN;this.closed=new H;this.keyStatuses=new hb}s(fb,F);k=fb.prototype;k.ready=function(){ib(this,"usable");this.O&&this.O.resolve();this.O=null};
k.handleError=function(a){var b=Error("EME v0.1b key error");b.errorCode=a.errorCode;b.errorCode.systemCode=a.systemCode;!a.sessionId&&this.X?(b.method="generateRequest",45==a.systemCode&&(b.message="Unsupported session type."),this.X.reject(b),this.X=null):a.sessionId&&this.O?(b.method="update",this.O.reject(b),this.O=null):(b=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?ib(this,"output-not-allowed"):1==b?ib(this,"expired"):ib(this,"internal-error"))};
function jb(a,b,c){if(a.Yc)return Promise.reject(Error("The session is already initialized."));a.Yc=!0;try{var d;if("persistent-license"==a.Ra)if(c)d=Ta("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=Ta("PERSISTENT|"+Sa(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.X=new H;try{a.za.webkitGenerateKeyRequest(a.La,d)}catch(g){if("InvalidStateError"!=g.name)return a.X=null,Promise.reject(g);setTimeout(function(){try{this.za.webkitGenerateKeyRequest(this.La,d)}catch(a){this.X.reject(a),
this.X=null}}.bind(a),10)}return a.X}
k.Mc=function(a,b){if(this.O)this.O.then(this.Mc.bind(this,a,b)).catch(this.Mc.bind(this,a,b));else{this.O=a;var c,d;if("webkit-org.w3.clearkey"==this.La){c=Sa(new Uint8Array(b));d=JSON.parse(c);c=d.keys[0].kty;if("A128KW"!=d.keys[0].alg||"oct"!=c)this.O.reject(Error("Response is not a valid JSON Web Key Set.")),this.O=null;c=Ua(d.keys[0].k);d=Ua(d.keys[0].kid)}else c=new Uint8Array(b),d=null;try{this.za.webkitAddKey(this.La,c,d,this.sessionId)}catch(e){this.O.reject(e),this.O=null}}};
function ib(a,b){var c=a.keyStatuses;c.size=void 0==b?0:1;c.ta=b;c=A({type:"keystatuseschange"});a.dispatchEvent(c)}k.generateRequest=function(a,b){return jb(this,b,null)};k.load=function(a){return"persistent-license"==this.Ra?jb(this,null,a):Promise.reject(Error("Not a persistent session."))};k.update=function(a){var b=new H;this.Mc(b,a);return b};
k.close=function(){if("persistent-license"!=this.Ra){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.za.webkitCancelKeyRequest(this.La,this.sessionId)}this.closed.resolve();return this.closed};k.remove=function(){return"persistent-license"!=this.Ra?Promise.reject(Error("Not a persistent session.")):this.close()};function kb(a){this.td=a;this.Xc=0}
kb.prototype.next=function(){return this.Xc>=this.td.length?{value:void 0,done:!0}:{value:this.td[this.Xc++],done:!1}};function hb(){this.size=0;this.ta=void 0}var lb=Ta("FAKE_KEY_ID");k=hb.prototype;k.forEach=function(a){this.ta&&a(this.ta)};k.get=function(a){if(this.has(a))return this.ta};k.has=function(a){return this.ta&&Ca(new Uint8Array(a),lb)?!0:!1};k.keys=function(){var a=[];this.ta&&a.push(lb);return new kb(a)};k.values=function(){var a=[];this.ta&&a.push(this.ta);return new kb(a)};function mb(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(Navigator.prototype.requestMediaKeySystemAccess=$a,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=bb,window.MediaKeys=eb,window.MediaKeySystemAccess=ab):(Navigator.prototype.requestMediaKeySystemAccess=oa,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=
null,HTMLMediaElement.prototype.setMediaKeys=pa,window.MediaKeys=qa,window.MediaKeySystemAccess=ra))}m("shaka.polyfill.MediaKeys.install",mb);m("shaka.polyfill.installAll",function(){ka();ma();mb();sa()});function nb(a){this.systemIds=[];this.cencKeyIds=[];a=new va(new DataView(a.buffer),0);try{for(;a.Ha();){var b=a.h,c=v(a),d=v(a);1==c?c=ya(a):0==c&&(c=a.j.byteLength-b);if(1886614376!=d)w(a,c-(a.h-b));else{var e=xa(a);if(1<e)w(a,c-(a.h-b));else{w(a,3);var f=Va(za(a)),g=[];if(0<e)for(var h=v(a),l=0;l<h;++l){var n=Va(za(a));g.push(n)}var p=v(a);w(a,p);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);a.h!=b+c&&w(a,c-(a.h-b))}}}}catch(q){}};var ob=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function J(a){var b;a instanceof J?(pb(this,a.Aa),this.Sa=a.Sa,this.oa=a.oa,qb(this,a.gb),this.ha=a.ha,rb(this,a.Na.clone()),this.Ga=a.Ga):a&&(b=String(a).match(ob))?(pb(this,b[1]||"",!0),this.Sa=sb(b[2]||""),this.oa=sb(b[3]||"",!0),qb(this,b[4]),this.ha=sb(b[5]||"",!0),rb(this,b[6]||"",!0),this.Ga=sb(b[7]||"")):this.Na=new tb(null)}k=J.prototype;k.Aa="";k.Sa="";k.oa="";k.gb=null;k.ha="";k.Ga="";
k.toString=function(){var a=[],b=this.Aa;b&&a.push(ub(b,vb,!0),":");if(b=this.oa){a.push("//");var c=this.Sa;c&&a.push(ub(c,vb,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.gb;null!=b&&a.push(":",String(b))}if(b=this.ha)this.oa&&"/"!=b.charAt(0)&&a.push("/"),a.push(ub(b,"/"==b.charAt(0)?wb:xb,!0));(b=this.Na.toString())&&a.push("?",b);(b=this.Ga)&&a.push("#",ub(b,yb));return a.join("")};
k.resolve=function(a){var b=this.clone(),c=!!a.Aa;c?pb(b,a.Aa):c=!!a.Sa;c?b.Sa=a.Sa:c=!!a.oa;c?b.oa=a.oa:c=null!=a.gb;var d=a.ha;if(c)qb(b,a.gb);else if(c=!!a.ha){if("/"!=d.charAt(0))if(this.oa&&!this.ha)d="/"+d;else{var e=b.ha.lastIndexOf("/");-1!=e&&(d=b.ha.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||1==f.length&&
""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}c?b.ha=d:c=""!==a.Na.toString();c?rb(b,a.Na.clone()):c=!!a.Ga;c&&(b.Ga=a.Ga);return b};k.clone=function(){return new J(this)};function pb(a,b,c){a.Aa=c?sb(b,!0):b;a.Aa&&(a.Aa=a.Aa.replace(/:$/,""))}function qb(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.gb=b}else a.gb=null}function rb(a,b,c){b instanceof tb?a.Na=b:(c||(b=ub(b,zb)),a.Na=new tb(b))}
function sb(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function ub(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Ab),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Ab(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var vb=/[#\/\?@]/g,xb=/[\#\?:]/g,wb=/[\#\?]/g,zb=/[\#\?@]/g,yb=/#/g;function tb(a){this.wa=a||null}k=tb.prototype;k.P=null;k.Lb=null;
k.add=function(a,b){if(!this.P&&(this.P={},this.Lb=0,this.wa))for(var c=this.wa.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("="),f=null,g=null;0<=e?(f=c[d].substring(0,e),g=c[d].substring(e+1)):f=c[d];f=decodeURIComponent(f.replace(/\+/g," "));g=g||"";this.add(f,decodeURIComponent(g.replace(/\+/g," ")))}this.wa=null;(c=this.P.hasOwnProperty(a)&&this.P[a])||(this.P[a]=c=[]);c.push(b);this.Lb++;return this};
k.toString=function(){if(this.wa)return this.wa;if(!this.P)return"";var a=[],b;for(b in this.P)for(var c=encodeURIComponent(b),d=this.P[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.wa=a.join("&")};k.clone=function(){var a=new tb;a.wa=this.wa;if(this.P){var b={},c;for(c in this.P)b[c]=this.P[c].concat();a.P=b;a.Lb=this.Lb}return a};function Bb(){this.id=null;this.type="static";this.sa=this.d=null;this.Q=5;this.mb=this.Jb=this.wb=null;this.Jc=1;this.v=[]}function Cb(){this.A=this.I=this.M=this.d=this.duration=this.start=this.id=null;this.ua=[]}function Db(){this.A=this.I=this.M=this.d=this.W=this.m=this.height=this.width=this.contentType=this.lang=this.id=null;this.ma=[];this.S=[]}function Eb(){this.value=null}function Fb(){this.contentType=this.lang=this.id=null}
function Gb(){this.A=this.I=this.M=this.d=this.W=this.m=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.ma=[];this.tb=!1}function Hb(){this.value=this.schemeIdUri=null;this.children=[];this.pssh=null}function Ib(){this.parsedPssh=this.psshBox=null}function Jb(){this.url=null}function Kb(){this.d=null;this.n=1;this.Y=this.Pa=this.ya=this.s=null}
Kb.prototype.clone=function(){var a=new Kb;a.d=this.d?new J(this.d):null;a.n=this.n;a.s=this.s;a.ya=K(this.ya);a.Pa=K(this.Pa);a.Y=K(this.Y);return a};function Lb(){this.R=this.url=null}Lb.prototype.clone=function(){var a=new Lb;a.url=this.url?new J(this.url):null;a.R=K(this.R);return a};function Mb(){this.R=this.url=null}Mb.prototype.clone=function(){var a=new Mb;a.url=this.url?new J(this.url):null;a.R=K(this.R);return a};
function Nb(){this.d=null;this.n=1;this.w=this.s=null;this.U=1;this.Y=null;this.Qa=[]}Nb.prototype.clone=function(){var a=new Nb;a.d=this.d?new J(this.d):null;a.n=this.n;a.s=this.s;a.w=this.w;a.U=this.U;a.Y=K(this.Y);a.Qa=this.Qa.map(function(a){return a.clone()});return a};function Ob(){this.bb=this.K=null}Ob.prototype.clone=function(){var a=new Ob;a.K=this.K?new J(this.K):null;a.bb=K(this.bb);return a};function Pb(){this.n=1;this.w=this.s=null;this.U=1;this.nb=this.qa=this.Ia=this.fa=null}
Pb.prototype.clone=function(){var a=new Pb;a.n=this.n;a.s=this.s;a.w=this.w;a.U=this.U;a.fa=this.fa;a.Ia=this.Ia;a.qa=this.qa;a.nb=K(this.nb);return a};function Qb(){this.ec=[]}Qb.prototype.clone=function(){var a=new Qb;a.ec=this.ec.map(function(a){return a.clone()});return a};function Rb(){this.repeat=this.duration=this.startTime=null}Rb.prototype.clone=function(){var a=new Rb;a.startTime=this.startTime;a.duration=this.duration;a.repeat=this.repeat;return a};
function Sb(a,b){this.qb=a;this.end=b}Sb.prototype.clone=function(){return new Sb(this.qb,this.end)};Bb.TAG_NAME="MPD";Cb.TAG_NAME="Period";Db.TAG_NAME="AdaptationSet";Eb.TAG_NAME="Role";Fb.TAG_NAME="ContentComponent";Gb.TAG_NAME="Representation";Hb.TAG_NAME="ContentProtection";Ib.TAG_NAME="cenc:pssh";Jb.TAG_NAME="BaseURL";Kb.TAG_NAME="SegmentBase";Lb.TAG_NAME="RepresentationIndex";Mb.TAG_NAME="Initialization";Nb.TAG_NAME="SegmentList";Ob.TAG_NAME="SegmentURL";Pb.TAG_NAME="SegmentTemplate";
Qb.TAG_NAME="SegmentTimeline";Rb.TAG_NAME="S";Bb.prototype.parse=function(a,b){this.id=M(b,"id",N);this.type=M(b,"type",N)||"static";this.sa=M(b,"mediaPresentationDuration",Tb);this.Q=M(b,"minBufferTime",Tb,this.Q);this.wb=M(b,"minimumUpdatePeriod",Tb,this.wb);this.Jb=M(b,"availabilityStartTime",Ub,this.Jb);this.mb=M(b,"timeShiftBufferDepth",Tb,this.mb);this.Jc=M(b,"suggestedPresentationDelay",Tb,this.Jc);var c=O(this,b,Jb);this.d=Vb(a.d,c?c.url:null);this.v=Wb(this,b,Cb)};
Cb.prototype.parse=function(a,b){this.id=M(b,"id",N);this.start=M(b,"start",Tb);this.duration=M(b,"duration",Tb);var c=O(this,b,Jb);this.d=Vb(a.d,c?c.url:null);this.M=O(this,b,Kb);this.I=O(this,b,Nb);this.A=O(this,b,Pb);this.ua=Wb(this,b,Db)};
Db.prototype.parse=function(a,b){var c=O(this,b,Fb)||{},d=O(this,b,Eb);this.id=M(b,"id",N);this.lang=M(b,"lang",N,c.lang);this.contentType=M(b,"contentType",N,c.contentType);this.width=M(b,"width",P);this.height=M(b,"height",P);this.m=M(b,"mimeType",N);this.W=M(b,"codecs",N);this.tb=d&&"main"==d.value;this.lang&&(this.lang=Ia(this.lang));c=O(this,b,Jb);this.d=Vb(a.d,c?c.url:null);this.ma=Wb(this,b,Hb);!this.contentType&&this.m&&(this.contentType=this.m.split("/")[0]);this.M=a.M?Xb(this,b,a.M):O(this,
b,Kb);this.I=a.I?Xb(this,b,a.I):O(this,b,Nb);this.A=a.A?Xb(this,b,a.A):O(this,b,Pb);this.S=Wb(this,b,Gb);!this.m&&this.S.length&&(this.m=this.S[0].m,!this.contentType&&this.m&&(this.contentType=this.m.split("/")[0]))};Eb.prototype.parse=function(a,b){this.value=M(b,"value",N)};Fb.prototype.parse=function(a,b){this.id=M(b,"id",N);this.lang=M(b,"lang",N);this.contentType=M(b,"contentType",N);this.lang&&(this.lang=Ia(this.lang))};
Gb.prototype.parse=function(a,b){this.id=M(b,"id",N);this.bandwidth=M(b,"bandwidth",P);this.width=M(b,"width",P,a.width);this.height=M(b,"height",P,a.height);this.m=M(b,"mimeType",N,a.m);this.W=M(b,"codecs",N,a.W);this.lang=a.lang;var c=O(this,b,Jb);this.d=Vb(a.d,c?c.url:null);this.ma=Wb(this,b,Hb);this.M=a.M?Xb(this,b,a.M):O(this,b,Kb);this.I=a.I?Xb(this,b,a.I):O(this,b,Nb);this.A=a.A?Xb(this,b,a.A):O(this,b,Pb);0==this.ma.length&&(this.ma=a.ma)};
Hb.prototype.parse=function(a,b){this.schemeIdUri=M(b,"schemeIdUri",N);this.value=M(b,"value",N);this.pssh=O(this,b,Ib);this.children=Array.prototype.slice.call(b.childNodes)};Ib.prototype.parse=function(a,b){var c=Yb(b);if(c){this.psshBox=Ua(c);try{this.parsedPssh=new nb(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};Jb.prototype.parse=function(a,b){this.url=Yb(b)};
Kb.prototype.parse=function(a,b){this.d=a.d||this.d;this.n=M(b,"timescale",P,this.n);this.s=M(b,"presentationTimeOffset",Q,this.s);this.ya=M(b,"indexRange",Zb,this.ya);this.Pa=O(this,b,Lb)||this.Pa;this.Y=O(this,b,Mb)||this.Y};Lb.prototype.parse=function(a,b){var c=M(b,"sourceURL",N);this.url=Vb(a.d,c);this.R=M(b,"range",Zb,K(a.ya))};Mb.prototype.parse=function(a,b){var c=M(b,"sourceURL",N);this.url=Vb(a.d,c);this.R=M(b,"range",Zb)};
Nb.prototype.parse=function(a,b){this.d=a.d||this.d;this.n=M(b,"timescale",P,this.n);this.s=M(b,"presentationTimeOffset",Q,this.s);this.w=M(b,"duration",P,this.w);this.U=M(b,"startNumber",P,this.U)||1;this.Y=O(this,b,Mb)||this.Y;this.Qa=Wb(this,b,Ob)||this.Qa};Ob.prototype.parse=function(a,b){var c=M(b,"media",N);this.K=Vb(a.d,c);this.bb=M(b,"mediaRange",Zb)};
Pb.prototype.parse=function(a,b){this.n=M(b,"timescale",P,this.n);this.s=M(b,"presentationTimeOffset",Q,this.s);this.w=M(b,"duration",P,this.w);this.U=M(b,"startNumber",P,this.U)||1;this.fa=M(b,"media",N,this.fa);this.Ia=M(b,"index",N,this.Ia);this.qa=M(b,"initialization",N,this.qa);this.nb=O(this,b,Qb)||this.nb};Qb.prototype.parse=function(a,b){this.ec=Wb(this,b,Rb)};Rb.prototype.parse=function(a,b){this.startTime=M(b,"t",Q);this.duration=M(b,"d",Q);this.repeat=M(b,"r",Q)};
function Vb(a,b){var c=b?new J(b):null;return a?c?a.resolve(c):a:c}function Xb(a,b,c){var d=K(c);(b=$b(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function O(a,b,c){var d=null;if(b=$b(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}function $b(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}
function Wb(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function Yb(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function K(a){return a?a.clone():null}function M(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function Ub(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function Tb(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a=0;var c=Q(b[1]);c&&(a+=31536E3*c);(c=Q(b[2]))&&(a+=2592E3*c);(c=Q(b[3]))&&(a+=86400*c);(c=Q(b[4]))&&(a+=3600*c);(c=Q(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function Zb(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=Q(b[1]);if(null==a)return null;b=Q(b[2]);return null==b?null:new Sb(a,b)}function P(a){a=window.parseInt(a,10);return 0<a?a:null}function Q(a){a=window.parseInt(a,10);return 0<=a?a:null}function N(a){return a};function R(a,b,c,d,e,f){this.id=a;this.startTime=b;this.endTime=c;this.Ca=d;this.Xa=e;this.url=f}function ac(a,b,c){return new R(a.id,b,c,a.Ca,a.Xa,a.url)};function bc(a){this.cb=a}bc.prototype.parse=function(a,b,c){a=null;try{a=this.Dc(b,c)}catch(d){if(!(d instanceof RangeError))throw d;}return a};
bc.prototype.Dc=function(a,b){var c=new va(a,0),d=[],e=v(c);if(1936286840!=v(c))return null;1==e&&(e=ya(c));var f=xa(c);w(c,3);w(c,4);var g=v(c);if(0==g)return null;var h,l;0==f?(h=v(c),l=v(c)):(h=ya(c),l=ya(c));w(c,2);f=c.j.getUint16(c.h,c.wc);c.h+=2;e=b+e+l;for(l=0;l<f;l++){var n=v(c),p=(n&2147483648)>>>31,n=n&2147483647,q=v(c);v(c);if(1==p)return null;d.push(new R(l,h/g,(h+q)/g,e,e+n-1,this.cb));h+=q;e+=n}return d};function cc(a){this.yb=a};function S(a){this.g=a;this.ob=0;dc(this)}S.prototype.length=function(){return this.g.length};S.prototype.first=function(){if(0==this.g.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return this.g[0]};function T(a){if(0==a.g.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return a.g[a.g.length-1]}S.prototype.get=function(a){if(0>a||a>=this.g.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.g[a]};
function ec(a,b,c){var d=a.find(b);if(0>d)return null;for(var e=[];d<a.g.length;d++){e.push(a.g[d]);var f=a.g[d].endTime;if(!f||f>b+c)break}return new cc(e)}S.prototype.find=function(a){for(var b=0;b<this.g.length;b++)if(this.g[b].startTime>a)return b?b-1:0;return this.g.length-1};function fc(a,b){return a.map(function(a){return ac(a,a.startTime+b,null!=a.endTime?a.endTime+b:null)})}
function dc(a){var b,c=a.g;ba(c.every(function(a,e){var f=!0;0!=e&&(f=a.startTime>=b.startTime&&a.startTime<=b.endTime&&(a.endTime&&a.endTime>=b.endTime||e==c.length-1));b=a;return f}));ba(ta(c,function(a){return a.id}).length==c.length)};function gc(a){this.cb=a}gc.prototype.parse=function(a,b){var c=null;try{c=this.Dc(a,b)}catch(d){if(!(d instanceof RangeError))throw d;}return c};
gc.prototype.Dc=function(a,b){var c;var d=new y(a);if(440786851!=z(d).id)c=null;else if(c=z(d),408125543!=c.id)c=null;else{d=c.j.byteOffset;c=new y(c.j);for(var e=null;c.Ha();){var f=z(c);if(357149030==f.id){e=f;break}}if(e){c=new y(e.j);for(e=1E6;c.Ha();)if(f=z(c),2807729==f.id){e=Ea(f);break}c=e/1E9}else c=null;c=c?{me:d,we:c}:null}if(!c)return null;e=z(new y(b));if(475249515!=e.id)return null;d=c.me;c=c.we;for(var e=new y(e.j),f=[],g=-1,h=-1,l=0;e.Ha();){var n=z(e);if(187==n.id){var p;p=new y(n.j);
n=z(p);if(179!=n.id)p=null;else if(n=Ea(n),p=z(p),183!=p.id)p=null;else{p=new y(p.j);for(var q=0;p.Ha();){var r=z(p);if(241==r.id){q=Ea(r);break}}p={ye:n,ie:q}}p&&(n=c*p.ye,p=d+p.ie,0<=g&&(f.push(new R(l,g,n,h,p-1,this.cb)),++l),g=n,h=p)}}0<=g&&f.push(new R(l,g,null,h,null,this.cb));return f};function hc(a){this.url=a;this.i=new ic;this.Ab=this.od=this.kc=0;this.o=null;this.ia=new H;this.J=null}function ic(){this.body=null;this.ub=1;this.Qc=1E3;this.ke=2;this.le=.5;this.Tb=0;this.method="GET";this.responseType="arraybuffer";this.Ec={};this.qd=this.withCredentials=!1}function U(a){jc(a);a.i.body=null;a.ia=null;a.J=null}function jc(a){a.o&&(a.o.onload=null,a.o.onreadystatechange=null,a.o.onerror=null,a.o.ontimeout=null);a.o=null}k=hc.prototype;
k.$b=function(){if(this.o)return this.ia;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer"==this.i.responseType&&(b=Ta(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.ia;b.resolve(a);U(this);return b}if(0==this.url.lastIndexOf("idb:",0))return kc(this);this.kc++;this.od=
Date.now();this.Ab||(this.Ab=this.i.Qc);this.o=new XMLHttpRequest;a=this.url;this.J&&(a=new J(a),a.Na.add("_",Date.now()),a=a.toString());this.o.open(this.i.method,a,!0);this.o.responseType=this.i.responseType;this.o.timeout=this.i.Tb;this.o.withCredentials=this.i.withCredentials;this.o.onload=this.Qd.bind(this);this.i.qd&&(this.o.onreadystatechange=this.Vd.bind(this));this.o.onerror=this.Ac.bind(this);this.o.ontimeout=this.ce.bind(this);for(b in this.i.Ec)this.o.setRequestHeader(b,this.i.Ec[b]);
this.o.send(this.i.body);return this.ia};function kc(a){var b=a.url.split("/"),c=parseInt(b[2],10),d=parseInt(b[3],10),e=new lc(null,null);return mc(e).then(function(){return nc(e,c,d)}).then(I(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest));b.response=a;a=this.ia;a.resolve(b);V(e);U(this);return a})).catch(I(a,function(a){V(e);U(this);return Promise.reject(a)}))}
function oc(a,b,c){b=Error(b);b.type=c;b.status=a.o.status;b.url=a.url;b.method=a.i.method;b.body=a.i.body;b.ze=a.o;return b}k.abort=function(){if(this.o&&this.o.readyState!=XMLHttpRequest.DONE){this.o.abort();var a=oc(this,"Request aborted.","aborted");this.ia.reject(a);U(this)}};k.Qd=function(a){this.J&&this.J.sample(Date.now()-this.od,a.loaded);200<=this.o.status&&299>=this.o.status?(this.ia.resolve(this.o),U(this)):this.kc<this.i.ub?pc(this):(a=oc(this,"HTTP error.","net"),this.ia.reject(a),U(this))};
k.Vd=function(){if(this.o.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.o.getResponseHeader("Date"));a&&(ua=a-Date.now())}};k.Ac=function(){var a=oc(this,"Network failure.","net");this.ia.reject(a);U(this)};k.ce=function(){if(this.kc<this.i.ub)pc(this);else{var a=oc(this,"Request timmedout.","net");this.ia.reject(a);U(this)}};function pc(a){jc(a);window.setTimeout(a.$b.bind(a),a.Ab*(1+(2*Math.random()-1)*a.i.le));a.Ab*=a.i.ke};function qc(a){hc.call(this,a);this.i.responseType="text";this.i.ub=3;this.i.Tb=rc;this.i.qd=!0}s(qc,hc);var rc=0;qc.prototype.send=function(){var a=this.url;return this.$b().then(function(b){b=b.responseText;if(b=(new DOMParser).parseFromString(b,"text/xml")){var c={d:new J(a)};b=O(c,b,Bb)}else b=null;if(b)return Promise.resolve(b);b=Error("MPD parse failure.");b.type="mpd";return Promise.reject(b)})};function sc(a,b,c){hc.call(this,a);this.i.body=b;this.i.method="POST";this.i.ub=3;this.i.withCredentials=c;this.i.Tb=tc}s(sc,hc);var tc=0;sc.prototype.send=function(){return this.$b().then(function(a){return Promise.resolve(new Uint8Array(a.response))})};function uc(a,b,c,d,e){hc.call(this,a);if(b||c)this.i.Ec.Range="bytes="+(b+"-"+(null!=c?c:""));d&&(this.i.ub=d);e&&(this.i.Qc=e);this.i.Tb=vc}s(uc,hc);var vc=0;uc.prototype.send=function(){return this.$b().then(I(this,function(a){return Promise.resolve(a.response)}))};function wc(a,b,c){this.cd=a;this.ka=b;this.H=c;this.l=new D;this.Ka={};this.Ma=this.C=null;E(this.l,this.ka,"updateend",this.$d.bind(this))}var xc=1/60;wc.prototype.destroy=function(){this.abort();this.Ka=this.C=this.Ma=null;this.l.destroy();this.cd=this.ka=this.l=null};function yc(a,b){for(var c=a.ka.buffered,d=0;d<c.length;++d){var e=c.start(d)-xc,f=c.end(d)+xc;if(b>=e&&b<=f)return c.end(d)-b}return 0}k=wc.prototype;
k.Ya=function(a,b,c){if(this.C)return c=Error("Cannot fetch: previous operation not complete."),c.type="stream",Promise.reject(c);this.C=new Qa;b&&this.C.append(function(){return[zc(this,b),this.ic.bind(this)]}.bind(this));var d=!0;a=a.yb;if(a.length){for(var e=a[0].url.toString(),f=1;f<a.length;++f)if(a[f].url.toString()!=e){d=!1;break}if(d)Ac(this,a,c);else for(f=0;f<a.length;++f)Ac(this,[a[f]],c)}return this.G()};
k.clear=function(){if(this.C){var a=Error("Cannot clear: previous operation not complete.");a.type="stream";return Promise.reject(a)}this.C=new Qa;this.C.append(function(){var a;a:if(0==this.ka.buffered.length)Object.keys(this.Ka),a=Promise.resolve();else{try{this.ka.remove(0,Number.POSITIVE_INFINITY)}catch(c){a=Promise.reject(c);break a}this.Ka={};a=this.Ma=new H}return[a,this.ic.bind(this)]}.bind(this));return this.G()};k.reset=function(){this.Ka={}};
k.abort=function(){return this.C?this.C.abort():Promise.resolve()};
function Ac(a,b,c){ba(b.every(function(a){return a.url==b[0].url}));a.C.append(function(){var a=new uc(b[0].url.toString(),b[0].Ca,b[b.length-1].Xa,3,1E3*(b[0].endTime?b[0].endTime-b[0].startTime:1));a.J=this.H;return[a.send().catch(function(a){if(-1!=c.indexOf(a.status))this.C.end();else return Promise.reject(a)}.bind(this)),a.abort.bind(a)]}.bind(a));a.C.append(function(a){this.H.getBandwidth();return[zc(this,a),this.ic.bind(this)]}.bind(a));a.C.append(function(){for(var a=0;a<b.length;++a)this.Ka[b[a].id]=
!0}.bind(a))}k.G=function(){this.C.start();return this.C.Eb.then(function(){this.C=null}.bind(this)).catch(function(a){this.C=null;return Promise.reject(a)}.bind(this))};function zc(a,b){try{a.ka.appendBuffer(b)}catch(c){return Promise.reject(c)}a.Ma=new H;return a.Ma}k.ic=function(){"open"==this.cd.readyState&&this.ka.abort()};k.$d=function(){this.Ma.resolve();this.Ma=null};function Bc(){this.V=Cc++;this.id=null;this.timestampOffset=0;this.height=this.width=this.bandwidth=this.na=null;this.W=this.m="";this.K=null;this.enabled=!0;this.Gc=this.ba=this.f=this.ja=this.jb=null}var Cc=0;function Dc(a){return a.ja?a.Sc():Promise.resolve()}
function Ec(a){if(!a.jb||a.f)return Promise.resolve();if(!a.K)return a=Error("Cannot create segment index without a media URL."),a.type="stream",Promise.reject(a);var b=0<=a.m.indexOf("mp4"),c=0<=a.m.indexOf("webm");if(!b&&!c)return a=Error("Cannot create segment index with an unsupported MIME type."),a.type="stream",Promise.reject(a);if(c&&!a.ba&&!a.ja)return a=Error("Cannot create segment index for WebM content without an initialization segment."),a.type="stream",Promise.reject(a);var d=Fc(a);c&&
(d=d.then(a.Sc.bind(a)));return d=d.then(I(a,function(){var a=null,a=b?new bc(this.K):new gc(this.K),c=this.ba?new DataView(this.ba):null,d=new DataView(this.Gc),a=a.parse(c,d,this.jb.Ca);if(!a)return a=Error("Cannot parse segment references."),a.type="stream",Promise.reject(a);this.f=new S(a);return Promise.resolve()}))}function Fc(a){return a.Gc?Promise.resolve():a.jb.Ya().then(I(a,function(a){this.Gc=a;return Promise.resolve()}))}
Bc.prototype.Sc=function(){return this.ba?Promise.resolve():this.ja.Ya().then(I(this,function(a){this.ba=a;return Promise.resolve()}))};function Gc(a){var b=a.m||"";a.W&&(b+='; codecs="'+a.W+'"');return b}function Hc(){this.url=null;this.Ca=0;this.Xa=null}Hc.prototype.Ya=function(){return(new uc(this.url.toString(),this.Ca,this.Xa)).send()};function Ic(){this.V=Mc++;this.id=null;this.contentType="";this.e=[];this.Wa=[];this.lang="";this.tb=!1}var Mc=0;
Ic.prototype.pc=function(){for(var a=[],b=0;b<this.Wa.length;++b){var c=new Nc;c.id=this.V;c.pa=this.Wa[b];c.contentType=this.contentType;c.xa=this.e.length?Gc(this.e[0]):"";a.push(c)}return a};function Oc(){this.id=null;this.start=0;this.duration=null;this.u=[]}Oc.prototype.pc=function(){for(var a=[],b=0;b<this.u.length;++b)a.push.apply(a,this.u[b].pc());return a};function Pc(){this.Z=!1;this.Q=0;this.p=[]}function Nc(){this.id=0;this.pa=null;this.xa=this.contentType=""};function Qc(a){this.$a=a;this.b=new Pc}
Qc.prototype.hb=function(a){this.b=new Pc;for(var b=0;b<a.v.length;++b)for(var c=a.v[b],d=0;d<c.ua.length;++d){var e=c.ua[d];if("text"!=e.contentType)for(var f=0;f<e.S.length;++f){var g=e.S[f],h=0,h=h+(g.M?1:0),h=h+(g.I?1:0),h=h+(g.A?1:0);0==h?(e.S.splice(f,1),--f):1!=h&&(g.M?(g.I=null,g.A=null):g.I&&(g.A=null))}}Rc(a);for(b=0;b<a.v.length;++b)for(c=a.v[b],d=0;d<c.ua.length;++d){f=e=c.ua[d];g=null;for(h=0;h<f.S.length;++h){var l=f.S[h].m||"";g?l!=g&&(f.S.splice(h,1),--h):g=l}0==e.S.length&&(c.ua.splice(d,
1),--d)}this.b.Z="dynamic"==a.type;this.b.Q=a.Q||5;for(b=0;b<a.v.length;++b){c=a.v[b];d=new Oc;d.id=c.id;d.start=c.start||0;d.duration=c.duration;for(e=0;e<c.ua.length;++e){f=c.ua[e];g=new Ic;g.id=f.id;g.tb=f.tb;g.contentType=f.contentType||"";g.lang=f.lang||"";for(l=h=0;l<f.S.length;++l){var n=f.S[l],p=g.Wa.slice(0),q=n,r=p,u=[];if(0==q.ma.length)u.push(Ya());else if(this.$a)for(var x=0;x<q.ma.length;++x){var L=this.$a(q.ma[x]);L&&u.push(L)}if(0==r.length)Array.prototype.push.apply(r,u);else for(q=
0;q<r.length;++q){x=!1;for(L=0;L<u.length;++L)if(r[q].key()==u[L].key()){x=!0;break}x||(r.splice(q,1),--q)}if(!(0==p.length&&0<g.Wa.length)){r=a;u=c;q=n;n=new Bc;n.id=q.id;n.bandwidth=q.bandwidth;n.width=q.width;n.height=q.height;n.m=q.m||"";n.W=q.W||"";x=void 0;if(q.M)r=q.M,(r.ya||r.Pa&&r.Pa.R)&&r.d?(r.s&&(n.timestampOffset=-1*r.s/r.n),u=r.Pa,u||(u=new Lb,u.url=new J(r.d),u.R=r.ya?r.ya.clone():null),n.K=new J(r.d),n.jb=Sc(u),n.ja=Sc(r.Y),x=!0):x=!1;else if(q.I)if(r=q.I,!r.w&&1<r.Qa.length)x=!1;else{n.ja=
Sc(r.Y);for(var cb=0,u=[],q=0;q<r.Qa.length;++q){var x=r.Qa[q],L=0==q?0:cb,Jc=cb=null,Ld=L/r.n;r.w&&(cb=L+r.w,Jc=cb/r.n);var Kc=0,Lc=null;x.bb&&(Kc=x.bb.qb,Lc=x.bb.end);u.push(new R(L,Ld,Jc,Kc,Lc,new J(x.K)))}n.f=new S(u);x=!0}else q.A?(x=q.A,L=void 0,x=L=x.Ia?Tc(q,n):x.nb?Uc(this,r,u,q,n):x.w?Vc(r,u,q,n):!1):"text"==q.m.split("/")[0]&&(n.K=new J(q.d),x=!0);if(n=x?n:null)g.e.push(n),g.Wa=p,n.f&&0<n.f.length()&&(h=Math.max(h,T(n.f).endTime))}}d.u.push(g);d.duration||(d.duration=h,"dynamic"==a.type&&
(d.duration+=2592E3))}this.b.p.push(d)}};
function Rc(a){if(a.v.length){null==a.v[0].start&&(a.v[0].start=0);var b=function(a){return 0==a||!!a};"static"!=a.type&&(a.sa=null);b(a.sa)&&1==a.v.length&&!b(a.v[0].duration)&&(a.v[0].duration=a.sa);for(var c=0,d=!0,e=0;e<a.v.length;++e){var f=a.v[e-1],g=a.v[e],h=a.v[e+1]||{start:a.sa};!b(g.start)&&f&&b(f.start)&&b(f.duration)&&(g.start=f.start+f.duration);!b(g.duration)&&b(h.start)&&(g.duration=h.start-g.start);null!=g.start&&null!=g.duration?c+=g.duration:d=!1}b(a.sa)||(e=a.v[a.v.length-1],d?
a.sa=c:b(e.start)&&b(e.duration)?a.sa=e.start+e.duration:"static"==a.type&&(a.sa=c))}}function Tc(a,b){var c=a.A,d;if(c.fa){d=Wc(c.fa,a.id,1,a.bandwidth,0);if(!d)return!1;d=a.d?a.d.resolve(d):d}else d=new J(a.d);var e;var f=a.A;f.Ia?(e=new Lb,(f=Wc(f.Ia,a.id,null,a.bandwidth,null))?e.url=a.d&&f?a.d.resolve(f):f:e=null):e=null;if(!e)return!1;f=null;if(c.qa&&(f=Xc(a),!f))return!1;b.K=new J(d);c.s&&(b.timestampOffset=-1*c.s/c.n);b.jb=Sc(e);b.ja=Sc(f);return!0}
function Uc(a,b,c,d,e){if(null==c.start)return!1;c=d.A;if(!c.fa)return!1;var f;a:{var g=c.nb.ec,h=0,l=[];for(f=0;f<g.length;++f)for(var n=g[f].repeat||0,p=0;p<=n;++p){if(!g[f].duration){f=null;break a}var q;q=g[f].startTime&&0==p?g[f].startTime:0==f&&0==p?0:h;var r=q+g[f].duration;0<l.length&&q!=h&&(l[l.length-1].end=q);h=r;l.push({start:q,end:r})}f=l}if(!f)return!1;g=0;"dynamic"==b.type&&0<f.length&&(g=Math.max(0,f.length-2),g=f[g].start/c.n-(b.mb||0));h=[];for(l=0;l<f.length;++l)if(n=f[l].start,
p=n/c.n,q=f[l].end/c.n,!(p<g)){r=Wc(c.fa,d.id,l+c.U,d.bandwidth,n);if(!r)return!1;r=d.d?d.d.resolve(r):r;h.push(new R(n,p,q,0,null,new J(r)))}f=null;if(c.qa&&0<h.length&&(f=Xc(d),!f))return!1;c.s&&(e.timestampOffset=-1*c.s/c.n);if("dynamic"==b.type&&0<h.length)for(a=h[h.length-1].startTime-a.b.Q,a>=g||(a=g),l=0;l<h.length;++l)if(h[l].endTime>=a){e.na=h[l].startTime;break}e.ja=Sc(f);e.f=new S(h);return!0}
function Vc(a,b,c,d){if(null==b.start)return!1;var e=c.A;if(!e.fa)return!1;var f=0,g,h;if("dynamic"==a.type){var l;var n=(Date.now()+ua)/1E3,p=null!=a.Jb?a.Jb:n;if(p>n)l=null;else{var q=a.Q||0,r=a.Jc||0;l=e.w/e.n;p=n-(p+b.start);0>p?l=null:(n=p-2*l-a.mb,0>n&&(n=0),n=Math.ceil(n/l)*l,p-=l,0>p?l=null:(q=Math.floor(p/l)*l-r-q,0>q&&(q=0),q=Math.floor(q/l)*l,l={yd:n/l+1,current:(q>=n?q:n)/l+1}))}l&&(g=l.yd,h=l.current,f=h-g)}else g=1;l=0;if(0<=g){a:{if("static"==a.type)if(null!=b.duration)b=b.duration;
else{l=null;break a}else b=Math.min(b.duration||Number.POSITIVE_INFINITY,a.wb||Number.POSITIVE_INFINITY,120);l=Math.ceil(b/(e.w/e.n))}if(!l)return!1}b=f+l;f=[];for(l=0;l<b;++l){p=l+g;q=(p-1)*e.w;r=q/e.n;n=(q+e.w)/e.n;p=Wc(e.fa,c.id,p-1+e.U,c.bandwidth,(p-1+(e.U-1))*e.w);if(!p)return!1;p=c.d?c.d.resolve(p):p;f.push(new R(q,r,n,0,null,new J(p)))}g=null;if(e.qa&&0<f.length&&(g=Xc(c),!g))return!1;e.s&&(d.timestampOffset=-1*e.s/e.n);"dynamic"==a.type&&0<f.length&&(d.na=e.w/e.n*(h-1));d.ja=Sc(g);d.f=new S(f);
return!0}function Xc(a){var b=a.A;if(!b.qa)return null;var c=new Mb,b=Wc(b.qa,a.id,null,a.bandwidth,null);if(!b)return null;c.url=a.d&&b?a.d.resolve(b):b;return c}
function Wc(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a=a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$"==a)return"$";var d=f[b];if(null==d)return a;"RepresentationID"==b&&c&&(c=void 0);a=d.toString();c=window.parseInt(c,10)||1;c=Math.max(0,c-a.length);return Array(c+1).join("0")+a});try{return new J(a)}catch(g){if(g instanceof URIError)return null;throw g;}}
function Sc(a){if(!a)return null;var b=new Hc;b.url=a.url;a.R&&(b.Ca=a.R.qb,b.Xa=a.R.end);return b};function Yc(a,b,c){F.call(this,a);this.a=b;this.c=c;this.D=this.vb=null;this.l=new D;this.zb={};this.kb=[];this.fd=0;this.Ta=new H;this.Nc=null}s(Yc,F);Yc.prototype.destroy=function(){this.parent=null;for(var a=0;a<this.kb.length;++a)this.kb[a].close().catch(function(){});this.kb=[];this.zb=this.D=this.vb=null;this.l.destroy();this.a=this.c=this.l=null};
function Zc(a){for(var b=new C,c=a.c.Tc(),d=0;d<c.length;++d){var e=c[d];e.pa.keySystem||e.xa&&!$c(e.xa)||b.push(e.contentType,e)}for(var d={},e=!1,f=0;f<c.length;++f){var g=c[f];if(g.pa.keySystem&&!b.has(g.contentType)){var h=g.pa.keySystem,l=d[h];l||(l=d[h]={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:"optional",persistentState:a.c.Qb()?"required":"optional"});g.xa&&(h=g.contentType+"Capabilities",h in l&&(e=!0,l[h]||(l[h]=[]),l[h].push({contentType:g.xa})))}}if(!e)if(c.length)a.D=
c[0].pa;else throw a=Error("No DRM scheme info provided!"),a.type="drm",a;if(0==Object.keys(d).length)return a.c.Hc(b),a.Ta.resolve(),Promise.resolve();e=new H;d=ad(d,e);d=d.then(a.vd.bind(a,c,b));d=d.then(a.ue.bind(a));e.reject(null);return d}function bd(a,b){null==a.Nc&&(a.Nc=window.setTimeout(function(){var a=Error("Timeout waiting for sessions.");a.type="storage";this.Ta.reject(a)}.bind(a),b));return a.Ta}
function ad(a,b){for(var c in a){var d=a[c];b=b.catch(function(){return navigator.requestMediaKeySystemAccess(c,[d])})}return b}k=Yc.prototype;k.vd=function(a,b,c){for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var h=f[g];if(!b.has(h)){var l=e[h+"Capabilities"];if(l&&l.length){for(var l=l[0],n=[],p=0;p<a.length;++p){var q=a[p];if(q.pa.keySystem==d&&q.xa==l.contentType){n.push(q);this.D=this.D?Za(this.D,q.pa):q.pa;break}}b.set(h,n)}}}this.c.Hc(b);return c.createMediaKeys()};
k.ue=function(a){this.vb=a;return this.a.setMediaKeys(this.vb).then(I(this,function(){if(0<this.c.Mb().length)cd(this);else{for(var a=0;a<this.D.Ja.length;++a){var c=this.D.Ja[a];this.gd({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.D.Ja.length&&E(this.l,this.a,"encrypted",this.gd.bind(this))}}))};
k.gd=function(a){var b=new Uint8Array(a.initData),c=Array.prototype.join.apply(b);if(!this.zb[c]){try{var d=dd(this)}catch(e){d=B(e);this.dispatchEvent(d);this.Ta.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.zb[c]=!0;a.catch(I(this,function(a){if(this.zb){this.zb[c]=!1;var b=B(a);this.dispatchEvent(b);this.Ta.reject(a)}}));this.kb.push(d)}};
function cd(a){for(var b=a.c.Mb(),c=0;c<b.length;++c){var d=dd(a),e=d.load(b[c]);a.kb.push(d);e.catch(I(a,function(a){a=B(a);this.dispatchEvent(a)}))}}function dd(a){var b=a.c.Qb()?a.vb.createSession("persistent-license"):a.vb.createSession();E(a.l,b,"message",a.Yd.bind(a));E(a.l,b,"keystatuseschange",a.Pd.bind(a));return b}k.Yd=function(a){ed(this,a.target,this.D.ad,a.message,this.D.withCredentials,this.D.$c)};
k.Pd=function(a){var b=a.target.keyStatuses.values();for(a=b.next();!a.done;a=b.next()){var c=fd[a.value];c&&(c=Error(c),c.type=a.value,a=B(c),this.dispatchEvent(a))}};function ed(a,b,c,d,e,f){(new sc(c,d,e)).send().then(I(a,function(a){f&&(a=f(a));return b.update(a)})).then(I(a,function(){var a=A({type:"sessionReady",detail:b});this.dispatchEvent(a);this.fd++;this.fd>=this.kb.length&&this.Ta.resolve()})).catch(I(a,function(a){a.Be=b;a=B(a);this.dispatchEvent(a)}))}
var fd={"output-not-allowed":"The required output protection is not available.",expired:"A required key has expired and the content cannot be decrypted.","internal-error":"An unknown error has occurred in the CDM."};function gd(a,b,c,d,e){F.call(this,a);this.a=b;this.ka=d;this.F=new wc(c,d,e);this.H=e;this.B=null;this.Ob=0;this.Gb=this.xb=null;this.t=hd;this.Ra="";this.yc=!1}s(gd,F);var hd=0,id=15;gd.prototype.destroy=function(){this.t=null;this.Ea();this.H=this.B=this.xb=null;this.F.destroy();this.parent=this.a=this.ka=this.F=null};gd.prototype.Wc=function(){return this.t!=hd&&1!=this.t};gd.prototype.rc=function(){return 4==this.t};
gd.prototype.start=function(a,b){if(this.t==hd){this.B=a;this.Ra=a.m.split("/")[0];this.t=1;this.Ob=b;var c,d=[Ec(a),Dc(a)];Promise.all(d).then(I(this,function(){var d=ec(a.f,this.a.currentTime,b);if(!d)return Promise.reject(Error("No segments available."));c=d.yb[0].startTime;return this.F.Ya(d,a.ba,[404,410])})).then(I(this,function(){var b=this.ka.buffered.start(0)-c;this.t=3;b=A({type:"started",bubbles:!1,sd:b});this.dispatchEvent(b);jd(this,a);kd(this)})).catch(I(this,function(a){"aborted"!=
a.type&&(this.t=hd,a=B(a),this.dispatchEvent(a))}))}};k=gd.prototype;
k.dc=function(a,b){t("switch");t("switch logic");if(this.t!=hd)if(1==this.t||2==this.t)this.xb=this.dc.bind(this,a,b);else if(a==this.B)this.ga();else{this.t=2;this.Ea();var c=[Ec(a),Dc(a),this.F.abort()],d=this.a.paused;b&&this.a.pause();Promise.all(c).then(I(this,function(){var c;if(b)c=this.a.currentTime;else{c=this.H.getBandwidth();var d=a.bandwidth;c=Math.max(id,this.Ob)*d/c;d=yc(this.F,this.a.currentTime);c=this.a.currentTime+Math.min(c,d-1)}this.B=a;this.Ra=a.m.split("/")[0];this.F.reset();
c=ec(a.f,c,Math.max(id,this.Ob));if(!c)return Promise.reject(Error("No segments available."));ea("switch logic");t("switch fetch");return this.F.Ya(c,a.ba,[404,410])})).then(I(this,function(){ea("switch fetch");b&&(this.a.currentTime-=.001,d||this.a.play());jd(this,a);this.t=3;kd(this)})).catch(I(this,function(a){"aborted"!=a.type&&(a=B(a),this.dispatchEvent(a),this.t=3,this.ga())}))}};
function jd(a,b){var c=b.m.split("/")[0],c=A({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c)}function kd(a){if(a.xb){var b=a.xb;a.xb=null;b()}else a.ga()}
k.Fc=function(){this.t!=hd&&1!=this.t&&2!=this.t&&(this.Ea(),this.F.abort().then(I(this,function(){var a=this.a.currentTime,b=this.B.f.find(a);if(0>b)return ld(this),Promise.resolve();b=this.B.f.get(b);return 0<yc(this.F,a)&&this.F.Ka[b.id]?Promise.resolve():(this.yc=!0,this.F.clear())})).then(I(this,function(){this.t=3;this.ga()})).catch(I(this,function(a){"aborted"!=a.type&&(a=B(a),this.dispatchEvent(a))})))};k.bc=function(){};k.qc=function(){return!0};
k.ga=function(){this.Ea();var a=this.a.currentTime;yc(this.F,a)>=Math.max(id,this.Ob)?this.Gb=window.setTimeout(this.ga.bind(this),1E3):(a=md(this,a),0>a||a>=this.B.f.length()?ld(this):(a=this.B.f.get(a),this.F.Ya(new cc([a]),null,[]).then(I(this,function(){this.yc&&0<yc(this.F,this.a.currentTime)&&(this.yc=!1,this.a.currentTime+=.001);this.ga()})).catch(I(this,function(a){if("aborted"!=a.type){var c=B(a);this.dispatchEvent(c);c=[0,404,410];"net"==a.type&&-1!=c.indexOf(a.ze.status)&&(this.Gb=window.setTimeout(this.ga.bind(this),
5E3))}}))))};function md(a,b){for(var c=a.B.f.find(b);0<=c&&c<a.B.f.length();){var d=a.B.f.get(c);if(!a.F.Ka[d.id])break;c++}return c}function ld(a){if(4!=a.t){a.t=4;var b=A({type:"ended"});a.dispatchEvent(b)}}k.Ea=function(){this.Gb&&(window.clearTimeout(this.Gb),this.Gb=null)};function W(a,b){F.call(this,a);this.a=b;this.ca=this.B=null}s(W,F);W.prototype.destroy=function(){this.ca&&this.a.removeChild(this.ca);this.parent=this.a=this.B=this.ca=null};W.prototype.Wc=function(){return!0};W.prototype.rc=function(){return!0};W.prototype.start=function(a){this.B=a;a=this.qc();this.ca&&(this.bc(!1),this.a.removeChild(this.ca));this.ca=document.createElement("track");this.a.appendChild(this.ca);this.ca.src=this.B.K.toString();this.bc(a)};
W.prototype.dc=function(a){this.start(a,0)};W.prototype.Fc=function(){};W.prototype.bc=function(a){this.ca.track.mode=a?"showing":"disabled"};W.prototype.qc=function(){return this.ca?"showing"==this.ca.track.mode:!1};function nd(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function od(a){a.playTime+=fa("playing")/1E3}function pd(a,b){var c=new qd(b);a.streamHistory.push(new rd(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}
function qd(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.m;this.videoBandwidth=a.bandwidth}function rd(a){this.timestamp=(Date.now()+ua)/1E3;this.value=a};function X(a){F.call(this,null);this.a=a;this.c=null;this.l=new D;this.Fa=null;this.ra="en";this.hc=this.Vb=null;this.Va=!1;this.N=new nd;this.jc=!0;this.Ub=new Xa}s(X,F);m("shaka.player.Player",X);X.version="v1.3.0-39-g8a5e611";
X.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!HTMLVideoElement.prototype.getVideoPlaybackQuality&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!document.body.children};
function $c(a){return"text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a)}X.isTypeSupported=$c;X.prototype.destroy=function(){this.Lc().catch(function(){});this.l.destroy();this.a=this.l=null};X.prototype.destroy=X.prototype.destroy;
X.prototype.Lc=function(){if(!this.c)return Promise.resolve();this.Va&&sd(this);this.a.pause();Na(this.l);td(this);ud(this);this.Fa.destroy();this.Fa=null;this.a.src="";var a=this.a.setMediaKeys(null);this.c&&(this.c.destroy(),this.c=null);this.Va=!1;this.N=new nd;return a};X.prototype.unload=X.prototype.Lc;
X.prototype.load=function(a){var b=this.Lc();this.a.autoplay&&(t("load"),E(this.l,this.a,"timeupdate",this.Od.bind(this)));a.rb(this.jc);return b.then(I(this,function(){return a.load(this.ra)})).then(I(this,function(){this.c=a;this.c.lb(this.Ub);this.Fa=new Yc(this,this.a,this.c);return Zc(this.Fa)})).then(I(this,function(){E(this.l,this.a,"error",this.Ac.bind(this));E(this.l,this.a,"playing",this.Ud.bind(this));E(this.l,this.a,"pause",this.Sd.bind(this));return this.c.Pc(this,this.a)})).then(I(this,
function(){vd(this)})).catch(I(this,function(b){a.destroy();this.c=null;this.Fa&&(this.Fa.destroy(),this.Fa=null);var d=B(b);this.dispatchEvent(d);return Promise.reject(b)}))};X.prototype.load=X.prototype.load;k=X.prototype;k.Od=function(){ea("load");this.N.playbackLatency=fa("load")/1E3;this.l.Fb(this.a,"timeupdate")};k.Ac=function(a){this.a.error&&(a=this.a.error.code,a!=MediaError.MEDIA_ERR_ABORTED&&(a=Error(wd[a]||"Unknown playback error."),a.type="playback",a=B(a),this.dispatchEvent(a)))};
k.Ud=function(){t("playing");this.Va&&sd(this)};k.Sd=function(){ea("playing");od(this.N)};k.getStats=function(){this.a.paused||(ea("playing"),od(this.N),t("playing"));var a=this.N,b=this.a.getVideoPlaybackQuality();b&&(a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.N};X.prototype.getStats=X.prototype.getStats;X.prototype.Ad=function(){var a=this.a.videoWidth,b=this.a.videoHeight;return a&&b?{width:a,height:b}:null};X.prototype.getCurrentResolution=X.prototype.Ad;
X.prototype.getVideoTracks=function(){return this.c?this.c.getVideoTracks():[]};X.prototype.getVideoTracks=X.prototype.getVideoTracks;X.prototype.getAudioTracks=function(){return this.c?this.c.getAudioTracks():[]};X.prototype.getAudioTracks=X.prototype.getAudioTracks;X.prototype.Nb=function(){return this.c?this.c.Nb():[]};X.prototype.getTextTracks=X.prototype.Nb;X.prototype.Bb=function(a,b){return this.c?this.c.Bb(a,void 0==b?!0:b):!1};X.prototype.selectVideoTrack=X.prototype.Bb;
X.prototype.Yb=function(a){return this.c?this.c.Yb(a,!1):!1};X.prototype.selectAudioTrack=X.prototype.Yb;X.prototype.Zb=function(a){return this.c?this.c.Zb(a,!1):!1};X.prototype.selectTextTrack=X.prototype.Zb;X.prototype.sb=function(a){this.c&&this.c.sb(a)};X.prototype.enableTextTrack=X.prototype.sb;X.prototype.rb=function(a){this.jc=a;this.c&&this.c.rb(a)};X.prototype.enableAdaptation=X.prototype.rb;X.prototype.zd=function(){return this.jc};X.prototype.getAdaptationEnabled=X.prototype.zd;
X.prototype.Bd=function(){return this.a.currentTime};X.prototype.getCurrentTime=X.prototype.Bd;X.prototype.Cd=function(){return this.a.duration};X.prototype.getDuration=X.prototype.Cd;X.prototype.Dd=function(){return this.a.muted};X.prototype.getMuted=X.prototype.Dd;X.prototype.Gd=function(){return this.a.volume};X.prototype.getVolume=X.prototype.Gd;X.prototype.play=function(){this.md(1);this.a.play()};X.prototype.play=X.prototype.play;X.prototype.pause=function(){this.a.pause()};
X.prototype.pause=X.prototype.pause;X.prototype.requestFullscreen=function(){this.a.requestFullscreen()};X.prototype.requestFullscreen=X.prototype.requestFullscreen;X.prototype.seek=function(a){this.a.currentTime=a};X.prototype.seek=X.prototype.seek;X.prototype.se=function(a){id=0>a?0:a};X.prototype.setStreamBufferSize=X.prototype.se;X.prototype.Fd=function(){return id};X.prototype.getStreamBufferSize=X.prototype.Fd;X.prototype.ne=function(a){tc=a};X.prototype.setLicenseRequestTimeout=X.prototype.ne;
X.prototype.oe=function(a){rc=a};X.prototype.setMpdRequestTimeout=X.prototype.oe;X.prototype.re=function(a){vc=a};X.prototype.setRangeRequestTimeout=X.prototype.re;X.prototype.pe=function(a){this.a.muted=a};X.prototype.setMuted=X.prototype.pe;X.prototype.te=function(a){this.a.volume=a};X.prototype.setVolume=X.prototype.te;X.prototype.qe=function(a){this.ra=Ia(a)};X.prototype.setPreferredLanguage=X.prototype.qe;
X.prototype.md=function(a){ud(this);0<=a?this.a.playbackRate=a:(this.a.playbackRate=0,this.hd(this.a.currentTime,Date.now(),a))};X.prototype.setPlaybackRate=X.prototype.md;X.prototype.lb=function(a){if(!(a instanceof Xa))throw new TypeError("Argument must be a Restrictions instance.");this.Ub=a.clone();this.c&&this.c.lb(this.Ub)};X.prototype.setRestrictions=X.prototype.lb;X.prototype.Ed=function(){return this.Ub.clone()};X.prototype.getRestrictions=X.prototype.Ed;
X.prototype.Pb=function(){return this.c?this.c.Pb():!1};X.prototype.isLive=X.prototype.Pb;function ud(a){a.Vb&&(window.clearTimeout(a.Vb),a.Vb=null)}function vd(a){td(a);a.hc=window.setTimeout(a.de.bind(a),100)}function td(a){a.hc&&(window.clearTimeout(a.hc),a.hc=null)}X.prototype.hd=function(a,b,c){this.a.currentTime=a+(Date.now()-b)/1E3*c;this.Vb=window.setTimeout(this.hd.bind(this,a,b,c),100)};
function sd(a){ea("buffering");var b=a.N;b.bufferingTime+=fa("buffering")/1E3;a.Va=!1;a.dispatchEvent(A({type:"bufferingEnd"}))}X.prototype.de=function(){vd(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=b-this.a.currentTime,b=b+.05;this.Va?a>this.c.Uc()&&(sd(this),this.a.play()):b<this.a.duration&&.1>a&&!this.a.paused&&(this.Va=!0,this.a.pause(),this.N.bufferingHistory.push((Date.now()+ua)/1E3),t("buffering"),this.dispatchEvent(A({type:"bufferingStart"})))}};
var wd={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function xd(){}xd.prototype.hb=function(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.u.length;++d){for(var e=c.u[d],f=e,g=0;g<f.e.length;++g)$c(Gc(f.e[g]))||(f.e.splice(g,1),--g);0==e.e.length&&(c.u.splice(d,1),--d)}for(b=0;b<a.length;++b)for(c=a[b],d=0;d<c.u.length;++d)c.u[d].e.sort(yd)};function yd(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};function Y(){this.c=this.H=null;this.l=new D;this.fb=Number.POSITIVE_INFINITY;this.Rc=!0}m("shaka.media.SimpleAbrManager",Y);Y.prototype.destroy=function(){this.l.destroy();this.c=this.H=this.l=null};Y.prototype.start=function(a,b){this.H&&this.c||(this.H=a,this.c=b,this.fb=Date.now()+4E3,E(this.l,this.H,"bandwidth",this.zc.bind(this)),E(this.l,this.c,"adaptation",this.Nd.bind(this)))};Y.prototype.enable=function(a){this.Rc=a};
Y.prototype.getInitialVideoTrackId=function(){if(!this.c||!this.H)return null;var a=zd(this);return a?a.id:null};Y.prototype.zc=function(){if(this.Rc&&!(Date.now()<this.fb)){var a=zd(this);if(a){if(a.active){this.fb=Date.now()+3E3;return}this.c.Bb(a.id,!1)}this.fb=Number.POSITIVE_INFINITY}};Y.prototype.Nd=function(){this.fb==Number.POSITIVE_INFINITY&&(this.fb=Date.now()+3E4)};
function zd(a){var b=a.c.getVideoTracks();if(0==b.length)return null;b.sort(ja);var c;a:{c=a.c.getAudioTracks();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.H.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth&&(g=(g.bandwidth+c)/.85,a>=(f.bandwidth+c)/.95&&a<=g&&(d=f,d.active)))break}return d};function Ad(a,b,c){F.call(this,null);this.cb=a;this.rd=b;this.D=c?c:Ya();this.la=null}s(Ad,F);m("shaka.player.HttpVideoSource",Ad);Ad.prototype.destroy=function(){this.la&&(this.la.parentElement.removeChild(this.la),this.la=null);this.parent=this.D=null};k=Ad.prototype;k.Pc=function(a,b){this.parent=a;var c=b.mediaKeys;b.src=this.cb;c=b.setMediaKeys(c);this.rd&&(this.la=document.createElement("track"),this.la.src=this.rd,b.appendChild(this.la),this.la.track.mode="showing");return c};k.load=function(){return Promise.resolve()};
k.getVideoTracks=function(){return[]};k.getAudioTracks=function(){return[]};k.Nb=function(){return[]};k.Uc=function(){return 5};k.Tc=function(){var a=new Nc;a.pa=this.D;return[a]};k.Hc=function(){};k.Bb=function(){return!1};k.Yb=function(){return!1};k.Zb=function(){return!1};k.sb=function(a){this.la&&(this.la.track.mode=a?"showing":"disabled")};k.rb=function(){};k.lb=function(){};k.Mb=function(){return[]};k.Qb=function(){return!1};k.Pb=function(){return!1};function Z(a,b,c){F.call(this,null);this.b=a;this.ra="";this.Kb=null;this.aa=new MediaSource;this.video=null;this.r={};this.pd=0;this.Cc=1;this.xc=Number.POSITIVE_INFINITY;this.ab=Number.NEGATIVE_INFINITY;this.q=new C;this.ea=new D;this.G=null;this.Ib=new H;this.cc=!1;this.J=b;this.N=null;this.pb=c}s(Z,F);m("shaka.player.StreamVideoSource",Z);
Z.prototype.destroy=function(){this.G&&(this.G.abort(),this.G=null);this.ea.destroy();this.ea=null;this.pb.destroy();this.pb=null;Bd(this);this.parent=this.J=this.Ib=this.video=this.aa=this.Kb=this.r=null};k=Z.prototype;
k.Pc=function(a,b){if(!this.b||0==this.b.p.length){var c=Error("Manifest has not been loaded.");c.type="stream";return Promise.reject(c)}this.parent=a;this.video=b;this.N=a.getStats();E(this.ea,this.aa,"sourceopen",this.Rd.bind(this));E(this.ea,this.J,"bandwidth",this.zc.bind(this));c=this.video.mediaKeys;this.video.src=window.URL.createObjectURL(this.aa);c=this.video.setMediaKeys(c);return Promise.all([this.Ib,c])};
k.load=function(a){if(!this.b||0==this.b.p.length)return a=Error("The manifest contains no stream information."),a.type="stream",Promise.reject(a);this.ra=a;(new xd).hb(this.b.p);return 0==this.b.p.length||0==this.b.p[0].u.length?(a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a)):Promise.resolve()};
function Cd(a,b){var c=new C;a.b.p.forEach(function(a,b){c.push(a.id||""+b,a)});var d=new C;b.p.forEach(function(a,b){d.push(a.id||""+b,a)});for(var e=c.keys(),f=0;f<e.length;++f){var g=e[f],h=c.get(g);1<h.length||(g=d.get(g))&&0!=g.length&&1==g.length&&(h[0].duration=g[0].duration,Dd(a,h[0],g[0]))}}
function Dd(a,b,c){var d=new C;b.u.forEach(function(a,b){d.push(a.id||""+b,a)});var e=new C;c.u.forEach(function(a,b){e.push(a.id||""+b,a)});b=d.keys();for(c=0;c<b.length;++c){var f=b[c],g=d.get(f);1<g.length||(f=e.get(f))&&0!=f.length&&1==f.length&&Ed(a,g[0],f[0])}}
function Ed(a,b,c){var d=new C;b.e.forEach(function(a,b){d.push(a.id||""+b,a)});var e=new C;c.e.forEach(function(a,b){e.push(a.id||""+b,a)});c={};for(var f=d.keys(),g=0;g<f.length;++g){var h=f[g];c[h]=h;var l=d.get(h);1<l.length||((h=e.get(h))&&0!=h.length?1==h.length&&(l=l[0],h=h[0],l.timestampOffset=h.timestampOffset,l.na=h.na,l.ja=h.ja,l.ba=null,Fd(l,h)):Gd(a,b,l[0]))}f=e.keys();for(g=0;g<f.length;++g)h=f[g],c[h]||(c[h]=h,h=e.get(h),b.e.push(h[0]))}
function Fd(a,b){if(a.f&&b.f){var c=a.f,d=b.f;c.ob!=d.ob&&(d=new S(fc(d.g,c.ob-d.ob)));if(0==c.length())c.g=d.g.slice(0),dc(c);else if(0!=d.length()&&null!=T(c).endTime&&!(null!=T(d).endTime&&T(d).endTime<T(c).endTime)){if(T(c).endTime<=d.first().startTime)var e=ac(T(c),T(c).startTime,d.first().startTime),e=c.g.slice(0,-1).concat([e]);else{var f;for(f=0;f<c.g.length&&!(c.g[f].endTime>=d.first().startTime);++f);c.g[f].startTime<d.first().startTime?(e=ac(c.g[f],c.g[f].startTime,d.first().startTime),
e=c.g.slice(0,f).concat([e])):(c.first().startTime>d.first().startTime||d.first(),e=c.g.slice(0,f))}c.g=e.concat(d.g);dc(c)}a.f.length()}}function Gd(a,b,c){var d=a.r[b.contentType];if(d&&d.B==c){a=a.q.get(b.contentType);a:{for(var e=0;e<a.length;++e)for(var f=a[e],g=0;g<f.e.length;++g){var h=f.e[g];if(h!=c&&h.enabled){a=h;break a}}a=null}if(!a)return;d.dc(a,!0)}b.e.splice(b.e.indexOf(c),1)}
k.getVideoTracks=function(){if(!this.q.has("video"))return[];for(var a=this.r.video,a=(a=a?a.B:null)?a.V:0,b=[],c=this.q.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.e.length;++f){var g=e.e[f];if(g.enabled){var h=g.V,g=new ia(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0);b.push(g)}}return b};
k.getAudioTracks=function(){if(!this.q.has("audio"))return[];for(var a=this.r.audio,a=(a=a?a.B:null)?a.V:0,b=[],c=this.q.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.e.length;++g){var h=e.e[g],l=h.V,h=new ga(l,h.bandwidth,f);l==a&&(h.active=!0);b.push(h)}return b};
k.Nb=function(){if(!this.q.has("text"))return[];for(var a=this.r.text,b=a?a.B:null,b=b?b.V:0,c=[],d=this.q.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,h=0;h<f.e.length;++h){var l=f.e[h].V,n=new ha(l,g);l==b&&(n.active=!0,n.enabled=a.qc());c.push(n)}return c};k.Uc=function(){return this.b.Q||0};k.Tc=function(){return 0==this.b.p.length?[]:this.b.p[0].pc()};
k.Hc=function(a){for(var b={},c=this.b.p[0],d=0;d<c.u.length;++d){var e=c.u[d];b[e.V]=e}this.q.clear();c=a.keys();for(d=0;d<c.length;++d){var e=c[d],f=a.get(e);if("video"==e){var g=f[0].id;this.q.push(e,b[g])}else if("audio"==e)for(var g=f[0].xa.split(";")[0],h=0;h<f.length;++h){var l=f[h];l.xa.split(";")[0]==g&&this.q.push(e,b[l.id])}else for(h=0;h<f.length;++h)g=f[h].id,this.q.push(e,b[g])}this.cc=!0;if(a=this.q.get("audio"))Hd(this,a),this.q.set("audio",a),a=a[0].lang||this.ra,Ha(2,this.ra,a)&&
(this.cc=!1);if(a=this.q.get("text"))Hd(this,a),this.q.set("text",a),a=a[0].lang||this.ra,Ha(2,this.ra,a)||(this.cc=!1)};k.Bb=function(a,b){return Id(this,"video",a,b)};k.Yb=function(a,b){return Id(this,"audio",a,b)};k.Zb=function(a,b){return Id(this,"text",a,b)};k.sb=function(a){var b=this.r.text;b&&b.bc(a)};k.rb=function(a){this.pb.enable(a)};
k.lb=function(a){this.Kb=a;for(var b=0;b<this.b.p.length;++b)for(var c=this.b.p[b],d=0;d<c.u.length;++d)for(var e=c.u[d],f=0;f<e.e.length;++f){var g=e.e[f];g.enabled=!0;a.maxWidth&&g.width>a.maxWidth&&(g.enabled=!1);a.maxHeight&&g.height>a.maxHeight&&(g.enabled=!1);a.maxBandwidth&&g.bandwidth>a.maxBandwidth&&(g.enabled=!1);a.minBandwidth&&g.bandwidth<a.minBandwidth&&(g.enabled=!1)}};k.Mb=function(){return[]};k.Qb=function(){return!1};k.Pb=function(){return this.b?this.b.Z:!1};
function Id(a,b,c,d){if(!a.q.has(b))return!1;for(var e=a.q.get(b),f=0;f<e.length;++f)for(var g=e[f],h=0;h<g.e.length;++h){var l=g.e[h];if(l.V==c)return pd(a.N,l),a.r[b].dc(l,d),!0}return!1}function Hd(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(Ha(c,a.ra,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.tb){b.splice(d,1);b.splice(0,0,e);break}}
k.Rd=function(){this.ea.Fb(this.aa,"sourceopen");Jd(this).then(I(this,function(){this.Ib.resolve()})).catch(I(this,function(a){this.Ib.reject(a)}))};
function Jd(a){ba(0==Object.keys(a.r).length);if(!Kd(a)){if(a.b.Z)return Promise.resolve();a=Error("Not all streams are available.");a.type="stream";return Promise.reject(a)}var b=a.b.p[0].duration;null!=b&&(a.aa.duration=b);for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.q.has(e)&&b.push(a.q.get(e)[0])}a.Cc=a.video.playbackRate;a.video.playbackRate=0;a.pb.start(a.J,a);var f=Md(a,b);a.G=new Qa;a.G.append(function(){var a=[],b;for(b in f)a.push(Ec(f[b]));return[Promise.all(a)]}.bind(a));
a.G.append(function(){var a;(a=Nd(this))?(this.pd=this.b.Z?a.end:a.start,a=!0):a=!1;if(!a){var b=Error("The streams' timelines are disjoint.");b.type="stream";return[Promise.reject(b)]}a:{for(b in f){a=f[b];var c;if("text"==b)c=new W(this,this.video);else b:{c=a;var d=void 0;try{d=this.aa.addSourceBuffer(Gc(c))}catch(e){c=null;break b}try{d.timestampOffset=c.timestampOffset}catch(q){c=null;break b}c=new gd(this,this.video,this.aa,d,this.J)}if(!c){b=Error("Cannot create stream for "+Gc(a)+".");b.type=
"stream";b=Promise.reject(b);break a}this.r[b]=c}b=Promise.resolve()}return[b]}.bind(a));a.G.append(function(){this.jd(f);this.video.currentTime=this.pd;for(var a in this.r){var b=this.r[a];E(this.ea,b,"started",this.be.bind(this));E(this.ea,b,"ended",this.ae.bind(this));var c=f[a];pd(this.N,c);b.start(c,this.b.Q)}this.sb(this.cc);return[Promise.resolve()]}.bind(a));a.G.start();return a.G.Eb.then(I(a,function(){this.G=null})).catch(I(a,function(a){this.G=null;if("aborted"!=a.type&&(Bd(this),this.video.playbackRate=
this.Cc,!this.b.Z))return Promise.reject(a)}))}function Md(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=e.e[0];if("video"==e.contentType)for(var g=a.pb.getInitialVideoTrackId(),h=0;h<e.e.length&&(f=e.e[h],f.V!=g);++h);else"audio"==e.contentType&&(f=e.e[Math.floor(e.e.length/2)]);c[e.contentType]=f}return c}
function Kd(a){a=Ma(a.q);for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.e.length;++d){var e=c.e[d];if(!("text"==e.m.split("/")[0]||null!=e.jb||null!=e.f&&0<e.f.length()))return!1}return!0}
function Nd(a){for(var b=0,c=Number.POSITIVE_INFINITY,d=Ma(a.q),e=0;e<d.length;++e){var f=d[e];if("text"!=f.contentType)for(var g=0;g<f.e.length;++g){var h=f.e[g],l=h.f;l&&0!=l.length()&&(b=Math.max(b,l.first().startTime),null!=h.na?c=Math.min(c,h.na):null!=T(l).endTime&&(c=Math.min(c,T(l).endTime)))}}c==Number.POSITIVE_INFINITY&&(a=a.b.p[0].duration,null!=a&&(c=a));return b>c?null:{start:b,end:c}}function Bd(a){for(var b in a.r)a.r[b].destroy();a.r={}}k.jd=function(){};
k.be=function(a){this.xc=Math.min(this.xc,a.sd);this.ab=Math.max(this.ab,a.sd);for(var b in this.r)if(!this.r[b].Wc())return;if(0<=this.xc*this.ab)for(a=Ma(this.q),b=0;b<a.length;++b){var c=a[b];if("text"!=c.contentType)for(var d=0;d<c.e.length;++d){var e=c.e[d],f=e.f;if(f){var g=this.ab;f.ob+=g;f.g=fc(f.g,g);dc(f)}null!=e.na&&(e.na+=this.ab)}}this.Bc()};
k.Bc=function(){this.video.currentTime+=this.ab;this.video.playbackRate=this.Cc;var a=function(){this.video.removeEventListener("seeking",a);E(this.ea,this.video,"seeking",this.Xd.bind(this))}.bind(this);this.video.addEventListener("seeking",a)};k.ae=function(){if(!this.b.Z){for(var a in this.r)if(!this.r[a].rc())return;"open"==this.aa.readyState&&this.aa.endOfStream()}};k.Xd=function(){this.Sb()};k.Sb=function(){for(var a in this.r)this.r[a].Fc()};
k.zc=function(){var a=this.N,b=this.J.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new rd(b))};function Od(a,b,c,d){c||(c=new G);d||(d=new Y);Z.call(this,null,c,d);this.dd=a;this.eb=null;this.$a=b;this.Rb=this.Kc=null;this.uc=new Fa(5);this.Hb=null;this.T=this.L=this.sc=this.tc=this.fc=0;this.Ic=!1;this.Wb=null}s(Od,Z);m("shaka.player.DashVideoSource",Od);Od.prototype.destroy=function(){this.Ea();Pd(this);this.uc=this.$a=null;Z.prototype.destroy.call(this)};k=Od.prototype;
k.load=function(a){this.Rb=Date.now()/1E3;return(new qc(this.dd)).send().then(I(this,function(b){var c=new Qc(this.$a);c.hb(b);this.eb=b;this.fc=b.mb||0;this.b=c.b;b=Z.prototype.load.call(this,a);this.b.Z&&b.then(I(this,function(){Qd(this);Rd(this)}));return b}))};k.jd=function(){var a=Nd(this);a&&(this.tc=this.b.Z?Math.max(a.end-this.fc,a.start):a.start,this.sc=a.end,this.L=this.tc,this.T=this.sc,this.b.Z&&(Sd(this),Td(this)))};
k.Bc=function(){var a=Nd(this);if(a){var b=this.T-this.sc;this.L=a.start+(this.L-this.tc);this.T=a.end+b}Z.prototype.Bc.call(this);this.Ic=!0;Ud(this);E(this.ea,this.video,"play",this.Td.bind(this))};k.Sb=function(){var a=this.video.currentTime;a>=this.L-.01&&a<=this.T+.01?Z.prototype.Sb.call(this):this.video.currentTime=a<this.L?this.L:this.T};k.Td=function(){this.Sb()};
k.ga=function(){this.Ea();this.Rb=Date.now()/1E3;(null==this.eb.wb?Promise.resolve():(new qc(this.dd)).send().then(I(this,function(a){this.eb=a}))).then(I(this,function(){var a=new Qc(this.$a);a.hb(this.eb);this.fc=this.eb.mb||0;a=a.b;if(this.b&&0!=this.b.p.length){if(this.b.Q=a.Q,(new xd).hb(a.p),Cd(this,a),this.Kb&&this.lb(this.Kb),this.video&&!this.G)if(0==Object.keys(this.r).length)Jd(this);else if(this.b.Z)for(var b in this.r)a=this.r[b],a.rc()&&a.Fc()}else b=Error("Manifest has not been loaded."),
b.type="stream",b=B(b),this.dispatchEvent(b);for(b=0;b<this.b.p.length;++b)for(var a=this.b.p[b],c=0;c<a.u.length;++c)for(var d=a.u[c],e=0;e<d.e.length;++e){var f=d.e[e];if(f.f){f.f.length();var g=f.f,h=this.L;0!=g.g.length&&(T(g).endTime<=h?g.g=[]:(h=g.find(h),g.g=g.g.slice(h)));f.f.length()}}Qd(this);Rd(this);Sd(this)})).catch(I(this,function(a){a=B(a);this.dispatchEvent(a);Rd(this);Sd(this)}))};function Rd(a){var b=Math.max(a.eb.wb||0,3);a.Hb=window.setTimeout(a.ga.bind(a),1E3*b)}
function Sd(a){for(var b=0,c=0;c<a.b.p.length;++c)for(var d=a.b.p[c],e=0;e<d.u.length;++e)for(var f=d.u[e],g=0;g<f.e.length;++g){var h=f.e[g].f;if(h&&0!=h.length())var l=Math.max(0,h.length()-2),h=h.get(l),b=Math.max(b,h.startTime)}a.Kc=b-Ga(a.uc)-1}k.Wd=function(a){Pd(this);a=(Date.now()-a)/1E3;this.T-this.L+a>=this.fc&&(this.L+=a);this.Ic?this.T+=a:1>=this.T-this.L&&(this.T=this.L+1);null!=this.Kc&&this.T>=this.Kc&&(a=Date.now()/1E3-this.Rb,null!=this.Hb&&3<=a&&this.ga());this.Ic&&Ud(this);Td(this)};
function Ud(a){var b=A({type:"seekrangechanged",bubbles:!0,start:a.L,end:a.T});a.dispatchEvent(b)}function Td(a){a.Wb=window.setTimeout(a.Wd.bind(a,Date.now()),1E3)}k.Ea=function(){this.Hb&&(window.clearTimeout(this.Hb),this.Hb=null)};function Pd(a){a.Wb&&(window.clearTimeout(a.Wb),a.Wb=null)}function Qd(a){a.uc.sample(1,Date.now()/1E3-a.Rb)};function lc(a,b){F.call(this,b);this.va=null;this.H=a}s(lc,F);
function mc(a){if(!window.indexedDB)return Promise.reject(Error("Offline storage requires IndexedDB support."));var b=new H,c=window.indexedDB.open("content_database",1);c.onupgradeneeded=I(a,function(a){this.va=a.target.result;Vd(this,"group_store",{keyPath:"group_id"});Vd(this,"stream_index_store",{keyPath:"stream_id"});a=Vd(this,"content_store",{autoIncrement:"true"});a.createIndex("segment",["stream_id","segment_id"],{unique:!0});a.createIndex("stream","stream_id",{unique:!1})});c.onsuccess=I(a,
function(a){this.va=a.target.result;b.resolve()});c.onerror=function(){b.reject(c.error)};return b}function V(a){a.va&&a.va.close()}function Vd(a,b,c){a.va.objectStoreNames.contains(b)&&a.va.deleteObjectStore(b);return a.va.createObjectStore(b,c)}
function Wd(a,b,c,d,e){for(var f=[],g=0,h=0,l=Promise.resolve(),n=0;n<b.length;++n)var p=b[n],q=[Ec(p),Dc(p)],l=l.then(function(a){return Promise.all(a)}.bind(a,q)).then(function(a){g+=a.f.length()}.bind(a,p));for(n=0;n<b.length;++n)p=b[n],l=l.then(function(a){return Xd(this,a,g,h)}.bind(a,p)),l=l.then(function(a,b){h+=a.f.length();f.push(b)}.bind(a,p));return l.then(I(a,function(){return Yd(Zd(this))})).then(I(a,function(a){var b=new H,g={group_id:a,stream_ids:f,session_ids:c,duration:d,key_system:e.keySystem},
h=Zd(this).put(g);h.onsuccess=function(){b.resolve(a)};h.onerror=function(){b.reject(h.error)};return b}))}function Xd(a,b,c,d){var e=[Yd($d(a)),Yd(ae(a).index("stream"))],e=Promise.all(e).then(I(a,function(a){return{Db:Math.max(a[0],a[1]),ib:new ArrayBuffer(0),Xb:0,yb:[],oc:null,xe:c,kd:d}})),e=e.then(a.Hd.bind(a,b));return e=e.then(a.Id.bind(a,b))}
function Yd(a){var b=new H,c=a.openCursor(null,"prev");c.onsuccess=function(a){a.target.result?b.resolve(a.target.result.key+1):b.resolve(0)};c.onerror=function(){b.reject(c.error)};return b}k=lc.prototype;k.Id=function(a,b){var c=new H,d={stream_id:b.Db,mime_type:a.m,codecs:a.W,init_segment:a.ba,references:b.yb},e=$d(this).put(d);e.onsuccess=function(){c.resolve(b.Db)};e.onerror=function(){c.reject(e.error)};return c};
k.Hd=function(a,b){for(var c=a.f,d=Promise.resolve(),e=0;e<c.length();++e)var f=c.get(e),g=this.ud.bind(this,f,b),d=d.then(this.je.bind(this,f)),d=d.then(g);return d.then(function(){return Promise.resolve(b)}).catch(I(this,function(a){be(this,b.Db);return Promise.reject(a)}))};
k.ud=function(a,b,c){var d=new H;0==b.ib.byteLength&&(b.oc=a);b.ib=ce(b.ib,c);b.kd++;var e=A({type:"progress",detail:b.kd/b.xe*100,bubbles:!0});if(1048576<=b.ib.byteLength||null==a.endTime){c={stream_id:b.Db,segment_id:b.Xb,content:b.ib};var f=ae(this).put(c);b.yb.push({index:b.Xb,start_time:b.oc.startTime,start_byte:b.oc.Ca,end_time:a.endTime,url:"idb://"+b.Db+"/"+b.Xb});b.Xb++;b.ib=new ArrayBuffer(0);f.onerror=function(){d.reject(f.error)};f.onsuccess=I(this,function(){this.dispatchEvent(e);d.resolve()})}else this.dispatchEvent(e),
d.resolve();return d};function ce(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}k.je=function(a){a=new uc(a.url.toString(),a.Ca,a.Xa);a.J=this.H;return a.send()};function nc(a,b,c){return de(ae(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content)})}function ee(a,b){return de($d(a),b)}
function fe(a,b){return de(Zd(a),b).then(function(a){return a.hasOwnProperty("duration")||a.hasOwnProperty("key_system")?Promise.resolve(a):ee(this,a.Ce[0]).then(function(b){a.duration=b.duration;a.Jd=b.Jd;return Promise.resolve(a)})}.bind(a))}function ge(a){var b=new H,c=[],d=Zd(a).openCursor();d.onerror=function(){b.reject(d.error)};d.onsuccess=function(a){(a=a.target.result)?(c.push(a.key),a.continue()):b.resolve(c)};return b}
function de(a,b){var c=new H,d=a.get(b);d.onerror=function(){c.reject(d.error)};d.onsuccess=function(){if(d.result)c.resolve(d.result);else{var a=Error("Item not found.");a.type="storage";c.reject(a)}};return c}
function be(a,b){var c=new H,d=$d(a).delete(b);d.onerror=function(){c.reject(d.error)};var e=ae(a);e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess=function(a){if(a=a.target.result)e.delete(a.primaryKey),a.continue()};e.transaction.oncomplete=function(){c.resolve()};return c}k.lc=function(a){return fe(this,a).then(I(this,function(b){var c=[],d;for(d in b.stream_ids)c.push(be(this,b.stream_ids[d]));b=Zd(this);c.push(b.delete(a));return Promise.all(c)}))};
function ae(a){return he(a,"content_store")}function $d(a){return he(a,"stream_index_store")}function Zd(a){return he(a,"group_store")}function he(a,b){return a.va.transaction([b],"readwrite").objectStore(b)};function $(a,b,c){b||(b=new G);c||(c=new Y);Z.call(this,null,b,c);this.Vc=a;this.ac=[];this.timeoutMs=3E4}s($,Z);m("shaka.player.OfflineVideoSource",$);$.retrieveGroupIds=function(){var a=new lc(null,null),b=mc(a).then(function(){return ge(a)});b.then(function(){V(a)}).catch(function(){V(a)});return b};
$.prototype.ve=function(a,b,c,d){var e,f,g;a=new qc(a);var h=Ia(b);return a.send().then(I(this,function(a){var b=new Qc(c);b.hb(a);this.b=b.b;return this.b.Z?Promise.reject(Error("Unable to store live streams offline.")):Z.prototype.load.call(this,h)})).then(I(this,function(){var a=document.createElement("video");a.src=window.URL.createObjectURL(this.aa);e=new Yc(null,a,this);E(this.ea,e,"sessionReady",this.Zd.bind(this));return Zc(e)})).then(I(this,function(){g={};for(var a=Ma(this.q),b=0;b<a.length;++b)for(var c=
a[b],e=0;e<c.e.length;++e){var f=c.e[e];g[f.V]=f}return d()})).then(I(this,function(a){f=[];for(var b=0;b<a.length;++b){var c=a[b],d=g[c];if(d)f.push(d);else return Promise.reject(Error("Invalid stream ID chosen: "+c))}a=[];for(b=0;b<f.length;++b)a.push(Dc(f[b]));return Promise.all(a)})).then(I(this,function(){var a=["audio","video"];f=f.filter(function(b){return 0>a.indexOf(b.m.split("/")[0])?!1:!0});return ie(this,f)})).then(I(this,function(){return bd(e,this.timeoutMs)})).then(I(this,function(){return je(this,
f,e.D,this.b.p[0].duration)}))};$.prototype.store=$.prototype.ve;function ie(a,b){for(var c=[],d=0;d<b.length;++d)try{c[d]=a.aa.addSourceBuffer(Gc(b[d]))}catch(e){}if(b.length!=c.length)return c=Error("Error initializing streams."),c.type="storage",Promise.reject(c);for(d=0;d<b.length;++d)c[d].appendBuffer(b[d].ba);return Promise.resolve()}$.prototype.Zd=function(a){this.ac.push(a.detail.sessionId)};
function je(a,b,c,d){var e=new lc(a.J,a),f=mc(e);return f=f.then(I(a,function(){return Wd(e,b,this.ac,d,c)})).then(function(a){V(e);return Promise.resolve(a)}).catch(function(a){V(e);return Promise.reject(a)})}
$.prototype.load=function(a){var b=new lc(null,null),c,d;return mc(b).then(I(this,function(){return fe(b,this.Vc)})).then(I(this,function(a){var f=[];this.ac=a.session_ids;c=a.duration;d=a.key_system;for(var g=0;g<a.stream_ids.length;++g)f.push(ee(b,a.stream_ids[g]));return Promise.all(f)})).then(I(this,function(b){var f=c,g=d,h=new Pc;h.Q=5;for(var l=new Oc,n=0;n<b.length;++n){for(var p=b[n],q=[],r=0;r<p.references.length;r++){var u=p.references[r],u=new R(u.index,u.start_time,u.end_time,u.start_byte,
null,new J(u.url));q.push(u)}r=new Bc;q=new S(q);r.f=q;r.m=p.mime_type;r.W=p.codecs;r.ba=p.init_segment;p=new Wa(g,"",!1,null,null);q=new Ic;q.e.push(r);q.Wa.push(p);q.contentType=r.m.split("/")[0];l.u.push(q);l.duration=f}h.p.push(l);this.b=h;return Z.prototype.load.call(this,a)})).then(function(){V(b);return Promise.resolve()}).catch(function(a){V(b);return Promise.reject(a)})};
$.prototype.lc=function(){var a=new lc(null,null);return mc(a).then(a.lc.bind(a,this.Vc)).then(function(){V(a);return Promise.resolve()}).catch(function(b){V(a);return Promise.reject(b)})};$.prototype.deleteGroup=$.prototype.lc;$.prototype.Mb=function(){return this.ac};$.prototype.Qb=function(){return!0};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined")define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

